<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Cari Produk - Laksana Handicraft</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: sans-serif;
      background: linear-gradient(to bottom, #eeeeee, #cccccc);
      padding: 20px;
      margin: 0;
    }
    .container {
      max-width: 700px;
      margin: auto;
      background: #f2f2f2;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.1);
    }
    h1 { text-align: center; }
    label { display:block; margin-top:10px; font-weight:bold; }
    select, button {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 8px;
      border: 1px solid #bbb;
    }
    button {
      background: #333;
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    button:hover { background: #555; }
    .result {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      background: #fff;
      border: 1px solid #ddd;
    }
    .result p { margin: 5px 0; }
    .translate-box { margin-top: 20px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>🔍 Cari Produk</h1>

    <form id="searchForm">
      <label for="tokoh">Nama Tokoh:</label>
      <select id="tokoh">
        <option value="">-- Pilih Tokoh --</option>
        <option>Arjuna</option>
        <option>Bima</option>
        <option>Puntadewa</option>
        <option>Nakula</option>
        <option>Sadewa</option>
        <option>Custom Tokoh</option>
      </select>

      <label for="ukuran">Ukuran Produk:</label>
      <select id="ukuran">
        <option value="">-- Pilih Ukuran --</option>
        <option>Miniatur</option>
        <option>20cm</option>
        <option>25cm</option>
        <option>30cm</option>
        <option>Standar Pedalangan</option>
      </select>

      <label for="kualitas">Kualitas Produk:</label>
      <select id="kualitas">
        <option value="">-- Pilih Kualitas --</option>
        <option>Murah</option>
        <option>Alusan</option>
      </select>

      <button type="submit">Cari Produk</button>
    </form>

    <div id="results"></div>

    <!-- 🔽 Dropdown Translate -->
    <div class="translate-box">
      <select class="btn" onchange="doGTranslate(this);">
        <option value="">🌏 Pilih Bahasa</option>
        <option value="id|id">🇮🇩 Indonesia</option>
        <option value="id|en">🇬🇧 English</option>
        <option value="id|ms">🇲🇾 Melayu</option>
        <option value="id|ja">🇯🇵 日本語</option>
        <option value="id|zh-CN">🇨🇳 中文</option>
        <option value="id|ar">🇸🇦 العربية</option>
        <option value="id|fr">🇫🇷 Français</option>
        <option value="id|de">🇩🇪 Deutsch</option>
        <option value="id|es">🇪🇸 Español</option>
      </select>
    </div>
  </div>

  <script>
    let products = [];

    // Load data dari JSON
    fetch("products.json")
      .then(res => res.json())
      .then(data => products = data);

    document.getElementById("searchForm").addEventListener("submit", function(e){
      e.preventDefault();
      const tokoh = document.getElementById("tokoh").value;
      const ukuran = document.getElementById("ukuran").value;
      const kualitas = document.getElementById("kualitas").value;
      const resultsDiv = document.getElementById("results");
      resultsDiv.innerHTML = "";

      if (!tokoh && !ukuran && !kualitas) {
        resultsDiv.innerHTML = "<p style='color:red;'>⚠️ Silakan pilih minimal satu kriteria pencarian.</p>";
        return;
      }

      const filtered = products.filter(p =>
        (tokoh ? p.tokoh === tokoh : true) &&
        (ukuran ? p.ukuran === ukuran : true) &&
        (kualitas ? p.kualitas === kualitas : true)
      );

      if(filtered.length === 0){
        resultsDiv.innerHTML = "<p>Tidak ada produk ditemukan.</p>";
        return;
      }

      filtered.forEach(p => {
        if (p.varian) {
          p.varian.forEach(v => {
            resultsDiv.innerHTML += `
              <div class="result">
                <p><strong>Tokoh:</strong> ${p.tokoh}</p>
                <p><strong>Ukuran:</strong> ${p.ukuran} (${v.size})</p>
                <p><strong>Kualitas:</strong> ${p.kualitas}</p>
                <p><strong>Harga:</strong> ${v.harga}</p>
                <p><a href="${v.link}" target="_blank">🔗 Detail Produk</a></p>
              </div>
            `;
          });
        } else {
          resultsDiv.innerHTML += `
            <div class="result">
              <p><strong>Tokoh:</strong> ${p.tokoh}</p>
              <p><strong>Ukuran:</strong> ${p.ukuran}</p>
              <p><strong>Kualitas:</strong> ${p.kualitas}</p>
              <p><strong>Harga:</strong> ${p.harga}</p>
              <p><a href="${p.link}" target="_blank">🔗 Detail Produk</a></p>
            </div>
          `;
        }
      });
    });

    // Google Translate
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({pageLanguage: 'id'}, 'google_translate_element');
    }
    function doGTranslate(el) {
      if (el.value === '') return;
      var langPair = el.value.split('|');
      var lang = langPair[1];
      if (lang === 'id') {
        document.cookie = 'googtrans=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
        window.location.href = window.location.pathname;
        return;
      }
      var select = document.querySelector('.goog-te-combo');
      if (select) {
        select.value = lang;
        select.dispatchEvent(new Event('change'));
      }
    }
  </script>
  <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</body>
</html>