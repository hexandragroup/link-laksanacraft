<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Admin LaksanaCraft API</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-4">
  <h2>Admin LaksanaCraft</h2>

  <ul class="nav nav-tabs mb-3" id="tabMenu">
    <li class="nav-item"><a class="nav-link active" data-type="products" href="#">Products</a></li>
    <li class="nav-item"><a class="nav-link" data-type="links" href="#">Links</a></li>
  </ul>

  <div id="tableContainer"></div>
</div>

<script>
const API_BASE = "https://ancient-king-d447.hendraslaksono.workers.dev";
const tableContainer = document.getElementById("tableContainer");
const tabs = document.querySelectorAll("#tabMenu .nav-link");

async function loadData(type) {
  tableContainer.innerHTML = "Loading...";
  try {
    const res = await fetch(`${API_BASE}${type==='products'?'/products':'/links'}`);
    const data = await res.json();
    if (!Array.isArray(data)) { tableContainer.innerHTML = "Data invalid"; return; }

    let html = `<table class="table table-striped"><thead><tr>`;
    if(type==='products') html += "<th>ID</th><th>Tokoh</th><th>Ukuran</th><th>Kualitas</th><th>Link</th>";
    else html += "<th>Category</th><th>Title</th><th>URL</th><th>Icon</th>";
    html += "</tr></thead><tbody>";

    data.forEach(item=>{
      html+="<tr>";
      if(type==='products'){
        html+=`<td>${item.id}</td><td>${item.tokoh.join(", ")}</td><td>${item.ukuran.join(", ")}</td><td>${item.kualitas}</td><td><a href="${item.link}" target="_blank">Link</a></td>`;
      } else {
        html+=`<td>${Array.isArray(item.category)?item.category.join(", "):item.category}</td><td>${item.title}</td><td><a href="${item.url}" target="_blank">${item.url}</a></td><td>${item.icon}</td>`;
      }
      html+="</tr>";
    });

    html += "</tbody></table>";
    tableContainer.innerHTML = html;
  } catch(err){
    tableContainer.innerHTML = "Error: "+err.message;
  }
}

tabs.forEach(tab=>{
  tab.addEventListener("click",e=>{
    e.preventDefault();
    tabs.forEach(t=>t.classList.remove("active"));
    tab.classList.add("active");
    loadData(tab.dataset.type);
  });
});

// default load
loadData("products");
</script>
</body>
</html>