<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Admin Demo — LaksanaCraft</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4" style="background:#f4f6fb;">
<div class="container">
  <h3>Admin Demo — Produk / Links</h3>

  <div class="mb-3">
    <label>Pilih file:</label>
    <select id="fileSelect" class="form-select w-auto">
      <option value="products1.json">products1.json</option>
      <option value="products2.json">products2.json</option>
      <option value="data1.json">data1.json</option>
      <option value="data2.json">data2.json</option>
    </select>
    <button id="btnLoad" class="btn btn-primary btn-sm ms-2">Load</button>
  </div>

  <div class="table-responsive mt-3">
    <table class="table table-bordered table-striped" id="dataTable">
      <thead><tr></tr></thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script>
const API_BASE = "https://ancient-king-d447.hendraslaksono.workers.dev";

async function loadFile(file){
  try{
    const res = await fetch(`${API_BASE}/products?file=${file}`);
    let data;
    if(!res.ok){
      // coba /links
      const res2 = await fetch(`${API_BASE}/links?file=${file}`);
      data = await res2.json();
    } else {
      data = await res.json();
    }
    renderTable(data);
  }catch(e){
    alert("Failed to load JSON: "+e.message);
  }
}

function renderTable(data){
  const table = document.getElementById("dataTable");
  const thead = table.querySelector("thead tr");
  const tbody = table.querySelector("tbody");

  if(!Array.isArray(data) || data.length===0){
    thead.innerHTML = "";
    tbody.innerHTML = "<tr><td colspan='10'>Tidak ada data</td></tr>";
    return;
  }

  const cols = Object.keys(data[0]);
  thead.innerHTML = cols.map(c=>`<th>${c}</th>`).join("");
  tbody.innerHTML = data.map(row=>{
    return "<tr>"+cols.map(c=>{
      let val=row[c];
      if(Array.isArray(val)) val=JSON.stringify(val);
      return `<td>${val}</td>`;
    }).join("")+"</tr>";
  }).join("");
}

document.getElementById("btnLoad").onclick = ()=>{
  const file = document.getElementById("fileSelect").value;
  loadFile(file);
}

// Load default
loadFile("products1.json");
</script>
</body>
</html>