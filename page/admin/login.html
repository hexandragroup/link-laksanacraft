<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <title>Login Admin — LaksanaCraft</title>

  <!-- CSS utama -->
  <link rel="stylesheet" href="/assets/style/style.css">

  <!-- CSS khusus login -->
  <link rel="stylesheet" href="assets/login.css">
</head>

<body>
<script src="/assets/script/corner-menu.js"></script>

<div class="container login-box">

    <img src="https://url.laksanacraft.my.id/assets/logo.png" class="logo" alt="logo">

    <h1>Login Admin</h1>
    <p><em>Masukkan username/password atau GitHub Token</em></p>

    <!-- Username -->
    <input id="user" class="input" placeholder="Username">

    <!-- Password (icon di dalam input) -->
    <div class="password-wrap">
        <input id="pass" type="password" class="input password-input" placeholder="Password">

        <span id="togglePass" class="show-hide">
            <svg id="iconEye" width="20" viewBox="0 0 24 24" fill="none">
              <path d="M3 3L21 21" stroke="#555" stroke-width="2" stroke-linecap="round"/>
              <path d="M10.58 10.58C10.21 11 10 11.48 10 12C10 13.1 10.9 14 12 14C12.52 14 13 13.79 13.42 13.42M17.94 17.94C16.29 18.96 14.24 19.5 12 19.5C6 19.5 2 12 2 12C3.11 10.07 4.48 8.39 6.06 7.06M12 4.5C18 4.5 22 12 22 12C21.55 12.74 21.03 13.45 20.47 14.12" stroke="#555" stroke-width="2" stroke-linecap="round"/>
            </svg>
        </span>
    </div>

    <button id="btnSimple" class="btn btn-login">Login (Simple)</button>

    <hr>

    <input id="gh_token" class="input" placeholder="GitHub Token">

    <button id="btnGH" class="btn btn-token">Login dengan GitHub Token</button>

    <p id="msg" class="msg"></p>

    <footer>
        &copy; <span id="year"></span> Laksana Handicraft — Bantul, Indonesia
    </footer>
</div>

<script>
document.getElementById("year").textContent = new Date().getFullYear();
const API = "https://ancient-king-d447.hendraslaksono.workers.dev";

// ----------------------
//  SHOW / HIDE PASSWORD
// ----------------------
const passInput = document.getElementById("pass");
const togglePass = document.getElementById("togglePass");
const iconEye = document.getElementById("iconEye");

togglePass.onclick = () => {
    if (passInput.type === "password") {
        passInput.type = "text";
        iconEye.style.opacity = "0.4";
    } else {
        passInput.type = "password";
        iconEye.style.opacity = "1";
    }
};

// ---------- SIMPLE LOGIN ----------
btnSimple.onclick = () => {
    msg.textContent = "";
    const u = user.value.trim();
    const p = pass.value.trim();

    if (u === "admin" && p === "12345") {
        localStorage.setItem("isLoggedIn", "1");
        localStorage.setItem("LaksanaCraft_API_KEY", "simple");
        location.href = "/admin/";
    } else {
        msg.textContent = "Username atau password salah";
    }
};

// ---------- LOGIN TOKEN ----------
btnGH.onclick = async () => {
    msg.textContent = "";
    const token = gh_token.value.trim();
    if (!token) return msg.textContent = "Masukkan token GitHub";

    try {
        const res = await fetch(`${API}/products?file=products1.json`, {
            headers: { "Authorization": `token ${token}` }
        });

        if (res.ok) {
            localStorage.setItem("GH_TOKEN", token);
            localStorage.setItem("LaksanaCraft_API_KEY", "github");
            localStorage.setItem("isLoggedIn", "1");
            location.href = "/admin/";
        } else {
            msg.textContent = "Token salah atau akses ditolak";
        }
    } catch (e) {
        msg.textContent = "Kesalahan koneksi";
    }
};
</script>

</body>
</html>